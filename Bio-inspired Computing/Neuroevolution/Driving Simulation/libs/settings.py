"""
Configuration file for the Driving Simulation.
Contains global constants, physics parameters, colors, and checkpoint data.
"""

import os

# --- Screen and Graphics ---
SCREEN_WIDTH = 1200
SCREEN_HEIGHT = 800
FPS = 60
TRACK_IMAGE_FILE = "track.png"
HEADLESS_MODE = False           # Set False to watch training live

# --- Colors (RGB) ---
COLOR_BACKGROUND        = (211, 211, 211) 
COLOR_TEXT              = (0, 0, 0)
COLOR_CAR               = (0, 100, 255)
COLOR_SENSOR            = (255, 0, 0)
COLOR_CHECKPOINT        = (0, 255, 255)
COLOR_TARGET_CHECKPOINT = (255, 0, 255)

# UI Bar Colors
COLOR_BAR_BG        = (100, 100, 100)
COLOR_BAR_ACC       = (0, 255, 0)
COLOR_BAR_BRK       = (255, 0, 0)
COLOR_BAR_STEER     = (0, 150, 255)
COLOR_BAR_SPEED     = (255, 165, 0)

# --- Car Physical Properties ---
CAR_WIDTH = 6
CAR_HEIGHT = 12

PHYSICS = {
    "MAX_VELOCITY": 5.0,
    "ACCELERATION": 0.06,
    "BRAKE": 0.1,
    "DRAG": 0.01,
    "FRICTION": 0.02,
    "STEER_SPEED": 3.0,
}

# --- Sensors ---
SENSOR_ANGLES = [-90, -45, 0, 45, 90]   # Angles relative to car heading: -90 is left, 0 is straight, 90 is right
SENSOR_MAX_LENGTH = 100.0

# --- Evolution and Rewards ---
REWARDS = {
    "CHECKPOINT_PASS": 10,  # Points for crossing a checkpoint
    "LAP_COMPLETE": 500,    # Points for finishing a lap
}

# Evolution Rules
TIMEOUT_SECONDS = 3        # Kill car if no checkpoint passed in three seconds
MAX_GENERATION_TIME_SEC = 60
MAX_GENERATIONS = 100 

# NEAT Configuration Toggles
# -- If True: input layer has 6 nodes (5 sensors + 1 velocity). 
# -- If False: input layer has 5 nodes (5 sensors).
INCLUDE_VELOCITY_IN_INPUT = False 

# Node names for visualization/reporting
NEAT_NODE_NAMES = {
    -1: 'S1', -2: 'S2', -3: 'S3', -4: 'S4', -5: 'S5', 
    0: 'ACC', 1: 'BRK', 2: 'LFT', 3: 'RGT'
}
if INCLUDE_VELOCITY_IN_INPUT:
    NEAT_NODE_NAMES[-6] = 'VEL'

# --- File Paths ---
BASE_DIR = "outputs"
NN_CHECKPOINTS_DIR = os.path.join(BASE_DIR, "NN-checkpoints")
VIDEOS_DIR = os.path.join(BASE_DIR, "videos")

# --- Track Checkpoints ---
# List of line segments ((x1, y1), (x2, y2)) representing checkpoints
CHECKPOINTS = [
    ((619, 545), (611, 603)), 
    ((633, 547), (626, 608)), 
    ((646, 550), (640, 611)), 
    ((662, 553), (656, 615)), 
    ((679, 559), (674, 617)), 
    ((694, 563), (690, 623)), 
    ((703, 625), (707, 565)), 
    ((722, 569), (718, 631)), 
    ((737, 573), (734, 636)), 
    ((753, 580), (751, 639)), 
    ((769, 583), (767, 643)), 
    ((783, 586), (779, 647)), 
    ((797, 589), (793, 650)), 
    ((810, 594), (805, 653)), 
    ((824, 598), (819, 655)), 
    ((840, 601), (836, 658)), 
    ((847, 663), (851, 603)), 
    ((862, 607), (859, 666)), 
    ((874, 609), (871, 669)), 
    ((888, 614), (885, 674)), 
    ((902, 618), (900, 676)), 
    ((915, 621), (913, 682)), 
    ((929, 623), (927, 684)), 
    ((943, 630), (943, 688)), 
    ((961, 632), (956, 691)), 
    ((969, 698), (974, 635)), 
    ((982, 698), (990, 638)), 
    ((995, 704), (1007, 642)), 
    ((1008, 708), (1020, 647)), 
    ((1023, 712), (1036, 650)), 
    ((1041, 717), (1047, 656)), 
    ((1062, 660), (1056, 719)), 
    ((1072, 722), (1074, 661)), 
    ((1088, 726), (1089, 665)), 
    ((1103, 669), (1100, 729)), 
    ((1116, 674), (1114, 735)), 
    ((1128, 676), (1126, 736)), 
    ((1139, 677), (1141, 737)), 
    ((1140, 674), (1157, 732)), 
    ((1142, 672), (1170, 714)), 
    ((1143, 672), (1179, 699)), 
    ((1142, 667), (1182, 683)), 
    ((1141, 662), (1184, 665)), 
    ((1140, 657), (1186, 655)), 
    ((1138, 653), (1185, 643)), 
    ((1131, 652), (1178, 628)), 
    ((1127, 649), (1169, 610)), 
    ((1120, 644), (1154, 595)), 
    ((1111, 637), (1140, 588)), 
    ((1103, 633), (1131, 580)), 
    ((1091, 623), (1120, 573)), 
    ((1084, 611), (1113, 564)), 
    ((1078, 605), (1106, 559)), 
    ((1070, 593), (1101, 552)), 
    ((1064, 582), (1098, 543)), 
    ((1058, 570), (1093, 535)), 
    ((1051, 558), (1088, 524)), 
    ((1050, 546), (1084, 518)), 
    ((1045, 537), (1082, 504)), 
    ((1042, 517), (1081, 499)), 
    ((1038, 502), (1081, 497)), 
    ((1036, 486), (1079, 486)), 
    ((1034, 475), (1080, 476)), 
    ((1034, 462), (1076, 462)), 
    ((1031, 451), (1078, 452)), 
    ((1031, 443), (1078, 443)), 
    ((1028, 436), (1077, 432)), 
    ((1024, 422), (1072, 421)), 
    ((1017, 412), (1071, 410)), 
    ((1014, 406), (1066, 394)), 
    ((1011, 400), (1059, 376)), 
    ((1006, 393), (1052, 364)), 
    ((995, 386), (1046, 350)), 
    ((989, 378), (1036, 339)), 
    ((977, 372), (1024, 327)), 
    ((971, 369), (1013, 319)), 
    ((961, 369), (1001, 313)), 
    ((954, 364), (987, 305)), 
    ((946, 361), (974, 302)), 
    ((936, 355), (962, 300)), 
    ((923, 349), (952, 298)), 
    ((913, 344), (944, 293)), 
    ((903, 335), (934, 286)), 
    ((890, 327), (922, 280)), 
    ((880, 321), (915, 271)), 
    ((871, 315), (906, 266)), 
    ((863, 305), (897, 260)), 
    ((855, 298), (889, 254)), 
    ((847, 293), (883, 249)), 
    ((838, 287), (877, 242)), 
    ((832, 280), (871, 237)), 
    ((824, 274), (864, 233)), 
    ((816, 268), (854, 227)), 
    ((806, 260), (845, 218)), 
    ((798, 254), (833, 211)), 
    ((788, 249), (825, 204)), 
    ((781, 244), (815, 198)), 
    ((772, 239), (803, 189)), 
    ((762, 232), (792, 183)), 
    ((748, 228), (785, 173)), 
    ((741, 219), (772, 166)), 
    ((730, 212), (759, 160)), 
    ((716, 204), (748, 155)), 
    ((706, 198), (737, 148)), 
    ((696, 193), (728, 143)), 
    ((689, 189), (717, 137)), 
    ((680, 183), (707, 130)), 
    ((677, 181), (696, 125)), 
    ((674, 182), (681, 118)), 
    ((670, 182), (666, 114)), 
    ((667, 180), (653, 118)), 
    ((663, 180), (641, 125)), 
    ((662, 181), (631, 132)), 
    ((657, 187), (625, 140)), 
    ((654, 191), (621, 150)), 
    ((653, 192), (615, 163)), 
    ((651, 197), (608, 172)), 
    ((647, 200), (607, 185)), 
    ((647, 208), (605, 195)), 
    ((645, 216), (599, 204)), 
    ((644, 222), (596, 219)), 
    ((650, 230), (600, 229)), 
    ((648, 236), (603, 240)), 
    ((649, 239), (604, 253)), 
    ((607, 267), (655, 240)), 
    ((655, 238), (613, 275)), 
    ((654, 238), (620, 286)), 
    ((654, 240), (630, 294)), 
    ((656, 238), (645, 300)), 
    ((658, 234), (660, 299)), 
    ((660, 233), (669, 297)), 
    ((663, 232), (677, 292)), 
    ((667, 229), (685, 291)), 
    ((675, 225), (695, 290)), 
    ((694, 293), (693, 224)), 
    ((695, 292), (704, 227)), 
    ((695, 292), (716, 232)), 
    ((695, 294), (727, 240)), 
    ((698, 296), (737, 250)), 
    ((701, 299), (743, 264)), 
    ((705, 304), (749, 277)), 
    ((709, 311), (752, 291)), 
    ((710, 325), (755, 308)), 
    ((714, 334), (759, 329)), 
    ((713, 347), (762, 341)), 
    ((717, 360), (762, 353)), 
    ((716, 373), (765, 365)), 
    ((722, 384), (771, 373)), 
    ((724, 395), (776, 381)), 
    ((731, 402), (781, 389)), 
    ((733, 411), (789, 392)), 
    ((743, 421), (790, 397)), 
    ((798, 395), (746, 431)), 
    ((800, 397), (755, 439)), 
    ((802, 397), (766, 447)), 
    ((805, 398), (775, 455)), 
    ((812, 399), (788, 457)), 
    ((828, 400), (800, 459)), 
    ((844, 404), (816, 464)), 
    ((860, 407), (830, 471)), 
    ((876, 414), (845, 473)), 
    ((891, 418), (861, 478)), 
    ((908, 423), (877, 480)), 
    ((925, 425), (895, 484)), 
    ((935, 429), (909, 488)), 
    ((954, 435), (923, 488)), 
    ((935, 491), (967, 442)), 
    ((938, 493), (981, 459)), 
    ((941, 493), (988, 473)), 
    ((942, 500), (992, 484)), 
    ((945, 503), (993, 501)), 
    ((943, 509), (993, 519)), 
    ((945, 511), (991, 534)), 
    ((944, 520), (988, 548)), 
    ((940, 529), (984, 561)), 
    ((936, 533), (977, 573)), 
    ((929, 535), (965, 589)), 
    ((923, 536), (946, 596)), 
    ((912, 533), (929, 603)), 
    ((904, 529), (908, 600)), 
    ((896, 530), (891, 589)), 
    ((885, 525), (878, 590)), 
    ((872, 524), (866, 588)), 
    ((857, 517), (850, 585)), 
    ((844, 515), (836, 580)), 
    ((832, 512), (825, 574)), 
    ((815, 508), (810, 570)), 
    ((802, 504), (795, 568)), 
    ((789, 500), (782, 562)), 
    ((774, 495), (766, 558)), 
    ((754, 493), (747, 556)), 
    ((736, 486), (731, 547)), 
    ((723, 483), (717, 544)), 
    ((707, 544), (711, 483)), 
    ((698, 477), (693, 542)), 
    ((685, 471), (682, 536)), 
    ((665, 532), (670, 468)), 
    ((655, 531), (657, 465)), 
    ((640, 527), (644, 462)), 
    ((625, 522), (630, 460)), 
    ((611, 519), (616, 456)), 
    ((601, 517), (605, 453)), 
    ((586, 514), (597, 450)), 
    ((575, 507), (592, 447)), 
    ((560, 506), (591, 448)), 
    ((552, 501), (586, 443)), 
    ((537, 497), (576, 442)), 
    ((528, 488), (568, 434)), 
    ((517, 475), (556, 432)), 
    ((508, 464), (554, 416)), 
    ((498, 439), (544, 412)), 
    ((493, 425), (542, 406)), 
    ((486, 415), (541, 403)), 
    ((484, 396), (538, 394)), 
    ((479, 373), (530, 373)), 
    ((478, 345), (530, 347)), 
    ((482, 316), (530, 322)), 
    ((489, 296), (533, 309)), 
    ((493, 276), (539, 294)), 
    ((502, 261), (543, 280)), 
    ((507, 243), (551, 261)), 
    ((513, 227), (560, 240)), 
    ((520, 210), (567, 222)), 
    ((520, 199), (564, 200)), 
    ((517, 182), (566, 183)), 
    ((516, 167), (563, 161)), 
    ((510, 157), (556, 140)), 
    ((505, 147), (552, 118)), 
    ((499, 135), (542, 100)), 
    ((487, 121), (528, 79)), 
    ((474, 114), (508, 61)), 
    ((459, 106), (485, 50)), 
    ((446, 102), (467, 42)), 
    ((437, 94), (452, 37)), 
    ((425, 100), (439, 26)), 
    ((417, 95), (422, 25)), 
    ((414, 93), (397, 31)), 
    ((417, 96), (384, 42)), 
    ((416, 90), (374, 58)), 
    ((414, 93), (369, 79)), 
    ((413, 95), (365, 93)), 
    ((412, 102), (364, 110)), 
    ((416, 110), (369, 132)), 
    ((425, 122), (379, 151)), 
    ((438, 138), (393, 170)), 
    ((452, 161), (403, 179)), 
    ((402, 192), (456, 182)), 
    ((404, 192), (455, 208)), 
    ((407, 195), (452, 232)), 
    ((402, 199), (441, 254)), 
    ((392, 206), (425, 270)), 
    ((375, 213), (402, 278)), 
    ((351, 230), (385, 284)), 
    ((328, 243), (361, 298)), 
    ((310, 256), (343, 314)), 
    ((294, 276), (325, 324)), 
    ((278, 294), (313, 339)), 
    ((261, 314), (300, 351)), 
    ((245, 327), (291, 365)), 
    ((236, 342), (280, 378)), 
    ((227, 359), (271, 392)), 
    ((217, 376), (263, 408)), 
    ((210, 388), (257, 424)), 
    ((208, 395), (250, 435)), 
    ((200, 401), (238, 450)), 
    ((199, 403), (225, 468)), 
    ((196, 406), (207, 480)), 
    ((189, 406), (180, 483)), 
    ((184, 405), (162, 472)), 
    ((181, 398), (145, 454)), 
    ((178, 396), (132, 433)), 
    ((179, 391), (126, 406)), 
    ((177, 384), (129, 380)), 
    ((174, 374), (129, 358)), 
    ((182, 355), (141, 336)), 
    ((192, 337), (148, 310)), 
    ((202, 315), (151, 291)), 
    ((208, 291), (166, 269)), 
    ((219, 277), (168, 251)), 
    ((228, 257), (175, 230)), 
    ((227, 233), (187, 205)), 
    ((240, 228), (198, 184)), 
    ((244, 225), (220, 166)), 
    ((256, 220), (236, 155)), 
    ((260, 219), (256, 155)), 
    ((274, 218), (271, 154)), 
    ((298, 215), (279, 150)), 
    ((315, 204), (287, 142)), 
    ((288, 139), (330, 181)), 
    ((289, 138), (340, 147)), 
    ((296, 130), (345, 130)), 
    ((287, 118), (345, 109)), 
    ((292, 106), (333, 80)), 
    ((282, 101), (325, 56)), 
    ((276, 90), (311, 41)), 
    ((265, 83), (297, 28)), 
    ((248, 83), (277, 15)), 
    ((243, 80), (252, 10)), 
    ((236, 78), (226, 10)), 
    ((228, 79), (198, 22)), 
    ((223, 81), (184, 31)), 
    ((217, 91), (168, 43)), 
    ((201, 96), (156, 59)), 
    ((194, 109), (146, 72)), 
    ((183, 119), (136, 93)), 
    ((179, 131), (121, 113)), 
    ((173, 143), (120, 130)), 
    ((169, 163), (116, 146)), 
    ((159, 178), (115, 160)), 
    ((161, 195), (103, 175)), 
    ((156, 209), (95, 193)), 
    ((149, 228), (98, 212)), 
    ((93, 229), (142, 246)), 
    ((85, 250), (139, 266)), 
    ((80, 271), (132, 288)), 
    ((81, 285), (125, 300)), 
    ((79, 302), (127, 314)), 
    ((72, 316), (123, 327)), 
    ((70, 336), (119, 349)), 
    ((67, 364), (114, 368)), 
    ((67, 383), (116, 392)), 
    ((65, 396), (113, 403)), 
    ((63, 410), (108, 419)), 
    ((59, 428), (109, 434)), 
    ((57, 442), (102, 449)), 
    ((54, 457), (100, 465)), 
    ((48, 470), (98, 480)), 
    ((54, 487), (95, 498)), 
    ((52, 500), (94, 513)), 
    ((44, 515), (94, 529)), 
    ((47, 532), (93, 544)), 
    ((44, 549), (89, 558)), 
    ((37, 565), (83, 575)), 
    ((36, 578), (83, 584)), 
    ((35, 600), (83, 595)), 
    ((91, 603), (38, 613)), 
    ((90, 610), (43, 633)), 
    ((96, 614), (52, 646)), 
    ((97, 618), (60, 672)), 
    ((105, 617), (75, 684)), 
    ((108, 621), (93, 691)), 
    ((114, 622), (118, 694)), 
    ((116, 620), (139, 686)), 
    ((118, 622), (159, 670)), 
    ((126, 612), (178, 660)), 
    ((145, 595), (198, 644)), 
    ((165, 578), (218, 630)), 
    ((185, 571), (239, 616)), 
    ((190, 553), (248, 602)), 
    ((214, 539), (264, 581)), 
    ((231, 518), (283, 562)), 
    ((250, 495), (302, 531)), 
    ((264, 473), (316, 511)), 
    ((275, 454), (325, 491)), 
    ((288, 439), (335, 474)), 
    ((297, 423), (351, 457)), 
    ((314, 408), (362, 443)), 
    ((370, 437), (324, 385)), 
    ((371, 432), (346, 361)), 
    ((385, 429), (362, 346)), 
    ((386, 432), (389, 345)), 
    ((389, 431), (417, 354)), 
    ((394, 434), (436, 370)), 
    ((399, 437), (444, 390)), 
    ((404, 447), (454, 416)), 
    ((405, 461), (458, 436)), 
    ((414, 467), (458, 455)), 
    ((413, 482), (462, 472)), 
    ((414, 504), (467, 488)), 
    ((419, 521), (472, 501)), 
    ((483, 502), (430, 539)), 
    ((489, 503), (450, 557)), 
    ((504, 511), (470, 565)), 
    ((519, 515), (488, 572)), 
    ((537, 519), (507, 577)), 
    ((557, 524), (528, 580)), 
    ((567, 527), (543, 588)), 
    ((583, 532), (562, 588)), 
    ((591, 531), (577, 598))
]